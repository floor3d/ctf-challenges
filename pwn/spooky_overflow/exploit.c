#include <stdio.h>
#include <stdlib.h>

/*
gcc -m32 -o exploit exploit.c -fno-stack-protector //How to compile
*/

int main() {

  int var;
  int check = 0x04030201;
  char buf[40];

  printf("Please enter a spooky input: ");

  fgets(buf, 45, stdin);

  printf("\n[buf]: %s\n", buf);
  printf("[overflow] %p\n", check);

  if ((check != 0x04030201) && (check != 0xdeadbeef)) {
    printf("Here is what I see now: ");
    printf("%p\n", check);
    printf("WRONG! I NEED DEADBEEF!");
  }

  if (check == 0xdeadbeef) {
    printf("CTF{buff3r_b33f_pwn}");
    printf("Thank you... MWAHAAHHAHHHAH!\n");
  }
  return 0;
}
